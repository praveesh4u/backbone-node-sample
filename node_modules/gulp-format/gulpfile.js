var gulp = require('gulp');
var bump = require('gulp-bump');
var format = require('./');

gulp.task('format.check', function() {
  return gulp.src('*.js')
      .pipe(format.check('file'))
      .on('warning', function(e) {
        process.stdout.write(e.message);
        process.exit(-1)
      });
});

gulp.task('format', function() {
  gulp.src('*.js')
      .pipe(format('file'))
      .on('info', function(e) { process.stdout.write(e.message); });
});

gulp.task('test', function() {
  gulp.src('test/*.js')
      .pipe(format.check({ColumnLimit: 10}))
      .on('warning', function(e) { process.stdout.write(e.message); });
});

gulp.task('build', ['format.check'], function() {
  gulp.src('./*.json').pipe(bump({type: 'build'})).pipe(gulp.dest('./'));
});
